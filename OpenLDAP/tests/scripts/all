#! /bin/sh
# $OpenLDAP: pkg/ldap/tests/scripts/all,v 1.7.8.3 2000/06/13 17:57:44 kurt Exp $

# disable LDAP initialization
LDAPNOINIT=true; export LDAPNOINIT

echo ">>>>> Executing all LDAP tests..."

if test $# -eq 0 ; then
	SRCDIR="."
else
	SRCDIR=$1; shift
fi

echo ">>>>> Test Directory: $SRCDIR"

if test $# -eq 0 ; then
	BACKEND=ldbm
else
	BACKEND=$1; shift
fi

echo ">>>>> Backend: $BACKEND"

for CMD in $SRCDIR/scripts/test*; do
	echo ">>>>> Starting `basename $CMD` ..."
	$CMD $SRCDIR $BACKEND
	RC=$?
	if test $RC -eq 0 ; then
		echo ">>>>> $CMD completed OK."
	else
		echo ">>>>> $CMD failed (exit $RC)"
		exit $RC
	fi
	echo ">>>>> waiting 10 seconds for things to exit"
	sleep 10
	echo
done
